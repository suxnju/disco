{
	"Language": "Solidity",
	"Source": "/*\r\n\r\n  Copyright 2018 Dexdex.\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n\r\n*/\r\n\r\npragma solidity ^0.4.21;\r\n\r\n\r\n/*\r\n * Ownable\r\n *\r\n * Base contract with an owner.\r\n * Provides onlyOwner modifier, which prevents function from running if it is called by anyone other than the owner.\r\n */\r\n\r\ncontract Ownable {\r\n    address public owner;\r\n\r\n    function Ownable()\r\n        public\r\n    {\r\n        owner = msg.sender;\r\n    }\r\n\r\n    modifier onlyOwner() {\r\n        require(msg.sender == owner);\r\n        _;\r\n    }\r\n\r\n    function transferOwnership(address newOwner)\r\n        public\r\n        onlyOwner\r\n    {\r\n        if (newOwner != address(0)) {\r\n            owner = newOwner;\r\n        }\r\n    }\r\n}\r\n\r\nlibrary SafeMath {\r\n    function safeMul(uint a, uint b)\r\n        internal\r\n        pure\r\n        returns (uint256)\r\n    {\r\n        uint c = a * b;\r\n        assert(a == 0 || c / a == b);\r\n        return c;\r\n    }\r\n\r\n    function safeDiv(uint a, uint b)\r\n        internal\r\n        pure\r\n        returns (uint256)\r\n    {\r\n        uint c = a / b;\r\n        return c;\r\n    }\r\n\r\n    function safeSub(uint a, uint b)\r\n        internal\r\n        pure\r\n        returns (uint256)\r\n    {\r\n        assert(b <= a);\r\n        return a - b;\r\n    }\r\n\r\n    function safeAdd(uint a, uint b)\r\n        internal\r\n        pure\r\n        returns (uint256)\r\n    {\r\n        uint c = a + b;\r\n        assert(c >= a);\r\n        return c;\r\n    }\r\n\r\n    function max64(uint64 a, uint64 b)\r\n        internal\r\n        pure\r\n        returns (uint256)\r\n    {\r\n        return a >= b ? a : b;\r\n    }\r\n\r\n    function min64(uint64 a, uint64 b)\r\n        internal\r\n        pure\r\n        returns (uint256)\r\n    {\r\n        return a < b ? a : b;\r\n    }\r\n\r\n    function max256(uint256 a, uint256 b)\r\n        internal\r\n        pure\r\n        returns (uint256)\r\n    {\r\n        return a >= b ? a : b;\r\n    }\r\n\r\n    function min256(uint256 a, uint256 b)\r\n        internal\r\n        pure\r\n        returns (uint256)\r\n    {\r\n        return a < b ? a : b;\r\n    }\r\n}\r\n\r\ncontract Members is Ownable {\r\n\r\n  mapping(address => bool) public members; // Mappings of addresses of allowed addresses\r\n\r\n  modifier onlyMembers() {\r\n    require(isValidMember(msg.sender));\r\n    _;\r\n  }\r\n\r\n  /// @dev Check if an address is a valid member.\r\n  function isValidMember(address _member) public view returns(bool) {\r\n    return members[_member];\r\n  }\r\n\r\n  /// @dev Add a valid member address. Only owner.\r\n  function addMember(address _member) public onlyOwner {\r\n    members[_member] = true;\r\n  }\r\n\r\n  /// @dev Remove a member address. Only owner.\r\n  function removeMember(address _member) public onlyOwner {\r\n    delete members[_member];\r\n  }\r\n}\r\n\r\ncontract IFeeWallet {\r\n\r\n  function getFee(\r\n    uint amount) public view returns(uint);\r\n\r\n  function collect(\r\n    address _affiliate) public payable;\r\n}\r\n\r\ncontract FeeWallet is IFeeWallet, Ownable, Members {\r\n\r\n  address public serviceAccount; // Address of service account\r\n  uint public servicePercentage; // Percentage times (1 ether)\r\n  uint public affiliatePercentage; // Percentage times (1 ether)\r\n\r\n  mapping (address => uint) public pendingWithdrawals; // Balances\r\n\r\n  function FeeWallet(\r\n    address _serviceAccount,\r\n    uint _servicePercentage,\r\n    uint _affiliatePercentage) public\r\n  {\r\n    serviceAccount = _serviceAccount;\r\n    servicePercentage = _servicePercentage;\r\n    affiliatePercentage = _affiliatePercentage;\r\n  }\r\n\r\n  /// @dev Set the new service account. Only owner.\r\n  function changeServiceAccount(address _serviceAccount) public onlyOwner {\r\n    serviceAccount = _serviceAccount;\r\n  }\r\n\r\n  /// @dev Set the service percentage. Only owner.\r\n  function changeServicePercentage(uint _servicePercentage) public onlyOwner {\r\n    servicePercentage = _servicePercentage;\r\n  }\r\n\r\n  /// @dev Set the affiliate percentage. Only owner.\r\n  function changeAffiliatePercentage(uint _affiliatePercentage) public onlyOwner {\r\n    affiliatePercentage = _affiliatePercentage;\r\n  }\r\n\r\n  /// @dev Calculates the service fee for a specific amount. Only owner.\r\n  function getFee(uint amount) public view returns(uint)  {\r\n    return SafeMath.safeMul(amount, servicePercentage) / (1 ether);\r\n  }\r\n\r\n  /// @dev Calculates the affiliate amount for a specific amount. Only owner.\r\n  function getAffiliateAmount(uint amount) public view returns(uint)  {\r\n    return SafeMath.safeMul(amount, affiliatePercentage) / (1 ether);\r\n  }\r\n\r\n  /// @dev Collects fees according to last payment receivedi. Only valid smart contracts.\r\n  function collect(\r\n    address _affiliate) public payable onlyMembers\r\n  {\r\n    if(_affiliate == address(0))\r\n      pendingWithdrawals[serviceAccount] += msg.value;\r\n    else {\r\n      uint affiliateAmount = getAffiliateAmount(msg.value);\r\n      pendingWithdrawals[_affiliate] += affiliateAmount;\r\n      pendingWithdrawals[serviceAccount] += SafeMath.safeSub(msg.value, affiliateAmount);\r\n    }\r\n  }\r\n\r\n  /// @dev Withdraw.\r\n  function withdraw() public {\r\n    uint amount = pendingWithdrawals[msg.sender];\r\n    pendingWithdrawals[msg.sender] = 0;\r\n    msg.sender.transfer(amount);\r\n  }\r\n}",
	"ContractName": "FeeWallet",
	"CompilerVersion": "v0.4.21+commit.dfe3193c"
}